import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from OpenSSL import SSL

# Configuración del correo electrónico
correo = 'tu_correo@tu_dominio.com'
contraseña = 'tu_contraseña'
destinatario = 'destinatario@dominio.com'

# Configuración del certificado
certificado = '/ruta/al/certificado.cert'

def enviar_correo(cambios):
    msg = MIMEMultipart()
    msg['From'] = correo
    msg['To'] = destinatario
    msg['Subject'] = 'Cambios en el directorio en las últimas 24 horas'
    message = 'Se han detectado los siguientes cambios en el directorio en las últimas 24 horas:\n\n' + '\n'.join(cambios)
    msg.attach(MIMEText(message))

    contexto_ssl = SSL.Context(SSL.SSLv23_METHOD)
    contexto_ssl.use_certificate_file(certificado)

    mailServer = smtplib.SMTP('smtp.office365.com', 587)
    mailServer.starttls(context=contexto_ssl)
    mailServer.login(correo, contraseña)
    mailServer.sendmail(correo, destinatario, msg.as_string())
    mailServer.close()




PNq.p_w7U9JT)C)S1F


5b0RzI2KytXu6Sv3gF9lZ8
